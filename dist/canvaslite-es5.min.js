!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1).element,u=n(2).element,s=document,a=function(){function e(t){r(this,e),this.rootEl=s.getElementById(t),this.canvasEl=s.createElement("canvas"),this.rootEl.appendChild(this.canvasEl),this.context=this.canvasEl.getContext("2d")}return o(e,[{key:"element",value:function(){return new i(this)}},{key:"group",value:function(){return new u(this)}}]),e}();e.exports=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2).element,u=function(){function e(t,n){if(r(this,e),!t)throw Error("canvas not provided");if(this.canvas=t,this.config={type:"basicEl",visible:!0},n){if(!(n instanceof i))throw Error("Not a proper Group");this.group=n}else this.group=t.rootGroup}return o(e,[{key:"group",value:function(e){return e?(this.group.remove(this),this.group=e,this):this.group}},{key:"erase",value:function(){var e;this.group.remove(this);for(e in this)this.hasOwnProperty(e)&&delete this[e];this.__notifyChange__()}},{key:"hide",value:function(){return this.config.visible&&(this.config.visible=!1,this.__notifyChange__()),this}},{key:"show",value:function(){return this.config.visible||(this.config.visible=!0,this.__notifyChange__()),this}},{key:"toggle",value:function(){return this.config.visible=!this.config.visible,this.__notifyChange__(),this}},{key:"__notifyChange__",value:function(){this.config.visible}}]),e}();e.exports={element:u}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var u=o.get;if(void 0!==u)return u.call(r)},a=n(1).element;console.log(a);var c=function(e){function t(e,n){r(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.config.type="group",i.__members__=[],i}return i(t,e),u(t,[{key:"__checkEl__",value:function(e){if(!(e instanceof a))throw Error("Only elements or groups can be added")}},{key:"__checkGroup__",value:function(e){if(!(e instanceof t))throw Error("Group expected")}},{key:"add",value:function(e){var t=0;if(!isNaN(e.length)){for(t=e.length;t--;)this.add(e[t]);return this}return this.__checkEl__(e),e.group.remove(e),e.group=this,this.__members__.push(e),this}},{key:"addAllFrom",value:function(e){var t=void 0,n=0;for(this.__checkGroup__(e),t=e.__members__,n=t.length;n--;);}},{key:"remove",value:function(e){var t=this.__members__,n=0,r=t.length,o=0;for(this.__checkEl__(e);n<r&&t[n]!==e;++n);if(n===r)throw Error("Element not in current group");for(o=n+1;o<r;++o)t[o-1]=t[o];return t.pop(),delete e.group,this}},{key:"removeAll",value:function(){for(var e=this.__members__,t=e.length;t--;)delete e[t].group;return this.__members__=[],this}},{key:"erase",value:function(){for(var e=this.__members__,n=e.length;n--;)e[n].erase();s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"erase",this).call(this)}}]),t}(a);e.exports={element:c}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vY2FudmFzbGl0ZS1lczUubWluLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA0ODc5NDlkMjc0OTQ2ODIwYTQzMSIsIndlYnBhY2s6Ly8vLi9zcmMvY29uc3RydWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0VsZW1lbnRzL0Jhc2ljRWxlbWVudC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvRWxlbWVudHMvR3JvdXAuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJwcm90b3R5cGUiLCJFbGVtZW50IiwiZWxlbWVudCIsIkdyb3VwIiwiZG9jIiwiZG9jdW1lbnQiLCJDYW52YXNMaXRlIiwidGhpcyIsInJvb3RFbCIsImdldEVsZW1lbnRCeUlkIiwiY2FudmFzRWwiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsInZhbHVlIiwiQmFzaWNFbGVtZW50IiwiY2FudmFzIiwiZ3JvdXAiLCJFcnJvciIsImNvbmZpZyIsInR5cGUiLCJ2aXNpYmxlIiwicm9vdEdyb3VwIiwicmVtb3ZlIiwiaGFzT3duUHJvcGVydHkiLCJfX25vdGlmeUNoYW5nZV9fIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiUmVmZXJlbmNlRXJyb3IiLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiX2dldCIsImdldCIsIm9iamVjdCIsInByb3BlcnR5IiwicmVjZWl2ZXIiLCJGdW5jdGlvbiIsImRlc2MiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1bmRlZmluZWQiLCJwYXJlbnQiLCJnZXRQcm90b3R5cGVPZiIsImdldHRlciIsImNvbnNvbGUiLCJsb2ciLCJfQmFzaWNFbGVtZW50IiwiX3RoaXMiLCJfX21lbWJlcnNfXyIsImlzTmFOIiwiYWRkIiwiX19jaGVja0VsX18iLCJwdXNoIiwiYXJyIiwiX19jaGVja0dyb3VwX18iLCJtZW1iZXJzIiwiaWkiLCJqIiwicG9wIiwiZXJhc2UiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FFLFdBQ0FFLEdBQUFKLEVBQ0FLLFFBQUEsRUFVQSxPQU5BUCxHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxRQUFBLEVBR0FGLEVBQUFELFFBdkJBLEdBQUFELEtBcUNBLE9BVEFGLEdBQUFRLEVBQUFULEVBR0FDLEVBQUFTLEVBQUFQLEVBR0FGLEVBQUFVLEVBQUEsR0FHQVYsRUFBQSxLRE1NLFNBQVNJLEVBQVFELEVBQVNILEdBRS9CLFlBSUEsU0FBU1csR0FBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FGaEgsR0FBSUMsR0FBZSxXQUFjLFFBQVNDLEdBQWlCQyxFQUFRQyxHQUFTLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJRCxFQUFNRSxPQUFRRCxJQUFLLENBQUUsR0FBSUUsR0FBYUgs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U0FBVzZCLFFBQVNDIiwiZmlsZSI6ImNhbnZhc2xpdGUtZXM1Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHR2YXIgRWxlbWVudCA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuZWxlbWVudCxcblx0ICAgIEdyb3VwID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKS5lbGVtZW50LFxuXHQgICAgZG9jID0gZG9jdW1lbnQ7XG5cdC8qKlxuXHQqIENvbnN0cnVjdG9yIGZ1bmN0aW9uIHRvIGluaXRpYWxpemUgQ2FudmFzTGl0ZVxuXHQqL1xuXHRcblx0dmFyIENhbnZhc0xpdGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgZnVuY3Rpb24gQ2FudmFzTGl0ZShpZCkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhbnZhc0xpdGUpO1xuXHRcblx0ICAgIHRoaXMucm9vdEVsID0gZG9jLmdldEVsZW1lbnRCeUlkKGlkKTtcblx0ICAgIHRoaXMuY2FudmFzRWwgPSBkb2MuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5cdCAgICB0aGlzLnJvb3RFbC5hcHBlbmRDaGlsZCh0aGlzLmNhbnZhc0VsKTtcblx0ICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzRWwuZ2V0Q29udGV4dCgnMmQnKTtcblx0ICB9XG5cdFxuXHQgIF9jcmVhdGVDbGFzcyhDYW52YXNMaXRlLCBbe1xuXHQgICAga2V5OiAnZWxlbWVudCcsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZWxlbWVudCgpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBFbGVtZW50KHRoaXMpO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2dyb3VwJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBncm91cCgpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBHcm91cCh0aGlzKTtcblx0ICAgIH1cblx0ICB9XSk7XG5cdFxuXHQgIHJldHVybiBDYW52YXNMaXRlO1xuXHR9KCk7XG5cdC8vIGV4cG9zaW5nIGNhbnZhc2xpdGUgdG8gZ2xvYmFsIHNwYWNlXG5cdFxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBDYW52YXNMaXRlO1xuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHR2YXIgR3JvdXAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpLmVsZW1lbnQ7XG5cdC8qKlxuXHQqIEJhc2ljIEVsZW1lbnQgY2xhc3Ncblx0KiBHcm91cHMgYW5kIG90aGVyIEVsZW1lbnRzIGluaGVyaXRzIHRoaXNcblx0KiBjb250YWlucyBiYXNpYyBtZXRob2RzIGFuZCBwcm9wZXJ0aWVzIHJlcXVpcmVkIGJ5IGFsbCBncm91cHMgb3IgZWxlbWVudHMuXG5cdCovXG5cdFxuXHR2YXIgQmFzaWNFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuXHQgIC8qKlxuXHQgICogQmFzaUVsZW1lbnQgY29uc3RydWN0b3Jcblx0ICAqIGFzc2lnbiB0aGUgZ3JvdXAsIHN0b3JlIGNhbnZhc1xuXHQgICogc2V0IHR5cGUgaW5pdGlhbGx5IHRvICdiYXNpY0VsJ1xuXHQgICovXG5cdCAgZnVuY3Rpb24gQmFzaWNFbGVtZW50KGNhbnZhcywgZ3JvdXApIHtcblx0ICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNpY0VsZW1lbnQpO1xuXHRcblx0ICAgIGlmICghY2FudmFzKSB7XG5cdCAgICAgIHRocm93IEVycm9yKCdjYW52YXMgbm90IHByb3ZpZGVkJyk7XG5cdCAgICB9XG5cdCAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcblx0ICAgIHRoaXMuY29uZmlnID0ge1xuXHQgICAgICB0eXBlOiAnYmFzaWNFbCcsXG5cdCAgICAgIHZpc2libGU6IHRydWVcblx0ICAgIH07XG5cdCAgICAvLyBJbml0aWFsbHkgYXNzaWduIHJvb3QgZ3JvdXAgaWZcblx0ICAgIC8vIGdyb3VwIG5vdCBwcm92aWRlZFxuXHQgICAgaWYgKGdyb3VwKSB7XG5cdCAgICAgIGlmICghKGdyb3VwIGluc3RhbmNlb2YgR3JvdXApKSB7XG5cdCAgICAgICAgdGhyb3cgRXJyb3IoJ05vdCBhIHByb3BlciBHcm91cCcpO1xuXHQgICAgICB9XG5cdCAgICAgIHRoaXMuZ3JvdXAgPSBncm91cDtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHRoaXMuZ3JvdXAgPSBjYW52YXMucm9vdEdyb3VwO1xuXHQgICAgfVxuXHQgIH1cblx0ICAvKipcblx0ICAqIEFzc2lnbiBuZXcgZ3JvdXAgb3Jcblx0ICAqIGdldCB0aGUgY3VycmVudCBhc3NpZ25lZCBncm91cFxuXHQgICovXG5cdFxuXHRcblx0ICBfY3JlYXRlQ2xhc3MoQmFzaWNFbGVtZW50LCBbe1xuXHQgICAga2V5OiAnZ3JvdXAnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGdyb3VwKF9ncm91cCkge1xuXHQgICAgICAvLyBJZiBncm91cCBpcyBwcm92aWRlZCBhc3NpZ24sIG90aGVyd2lzZVxuXHQgICAgICAvLyByZXR1cm4gY3VycmVudCBncm91cFxuXHQgICAgICBpZiAoX2dyb3VwKSB7XG5cdCAgICAgICAgdGhpcy5ncm91cC5yZW1vdmUodGhpcyk7XG5cdCAgICAgICAgdGhpcy5ncm91cCA9IF9ncm91cDtcblx0ICAgICAgICByZXR1cm4gdGhpcztcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5ncm91cDtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgLyoqXG5cdCAgICAqIEVyYXNlIGN1cnJlbnQgZWxlbWVudFxuXHQgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZXJhc2UnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGVyYXNlKCkge1xuXHQgICAgICB2YXIga2V5O1xuXHQgICAgICB0aGlzLmdyb3VwLnJlbW92ZSh0aGlzKTtcblx0ICAgICAgLy8gZGVsZXRlIGV2ZXJ5IHByb3BlcnR5IG9mIGVsZW1lbnRcblx0ICAgICAgZm9yIChrZXkgaW4gdGhpcykge1xuXHQgICAgICAgIGlmICh0aGlzLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICAgIHRoaXMuX19ub3RpZnlDaGFuZ2VfXygpO1xuXHQgICAgfVxuXHQgICAgLyoqXG5cdCAgICAqIEhpZGUgY3VycmVudCBlbGVtZW50XG5cdCAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdoaWRlJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBoaWRlKCkge1xuXHQgICAgICBpZiAodGhpcy5jb25maWcudmlzaWJsZSkge1xuXHQgICAgICAgIHRoaXMuY29uZmlnLnZpc2libGUgPSBmYWxzZTtcblx0ICAgICAgICB0aGlzLl9fbm90aWZ5Q2hhbmdlX18oKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH1cblx0ICAgIC8qKlxuXHQgICAgKiBTaG93IGN1cnJlbnQgZWxlbWVudFxuXHQgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnc2hvdycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdygpIHtcblx0ICAgICAgaWYgKCF0aGlzLmNvbmZpZy52aXNpYmxlKSB7XG5cdCAgICAgICAgdGhpcy5jb25maWcudmlzaWJsZSA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5fX25vdGlmeUNoYW5nZV9fKCk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9XG5cdCAgICAvKipcblx0ICAgICogVG9nZ2xlIGN1cnJlbnQgZWxlbWVudCdzIHZpc2liaWxpdHlcblx0ICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3RvZ2dsZScsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gdG9nZ2xlKCkge1xuXHQgICAgICB0aGlzLmNvbmZpZy52aXNpYmxlID0gIXRoaXMuY29uZmlnLnZpc2libGU7XG5cdCAgICAgIHRoaXMuX19ub3RpZnlDaGFuZ2VfXygpO1xuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH1cblx0ICAgIC8qKlxuXHQgICAgKiBCZWhhdmUgd2hlbiBwcm9wZXJ0eSBvZiBlbGVtZW50IGlzIGNoYW5nZWRcblx0ICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ19fbm90aWZ5Q2hhbmdlX18nLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIF9fbm90aWZ5Q2hhbmdlX18oKSB7XG5cdCAgICAgIGlmICh0aGlzLmNvbmZpZy52aXNpYmxlKSB7XG5cdCAgICAgICAgLy8gTm90aWZ5IGNoYW5nZSBvbmx5IGlmIHZpc2libGVcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH1dKTtcblx0XG5cdCAgcmV0dXJuIEJhc2ljRWxlbWVudDtcblx0fSgpO1xuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSB7IGVsZW1lbnQ6IEJhc2ljRWxlbWVudCB9O1xuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0LyoqXG5cdCogTWFuYWdlIGFsbCB0aGUgZ3JvdXAgZWxlbWVudHMgYmVsb25ncyB0b1xuXHQqL1xuXHR2YXIgQmFzaWNFbGVtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5lbGVtZW50O1xuXHRjb25zb2xlLmxvZyhCYXNpY0VsZW1lbnQpO1xuXHQvKipcblx0KiBNYW5hZ2UgZ3JvdXBzIHRoYXQgZWxlbWVudHMgYmVsb25nIHRvXG5cdCogZXh0ZW5kcyBCYXNpY0VsZW1lbnRcblx0Ki9cblx0XG5cdHZhciBHcm91cCA9IGZ1bmN0aW9uIChfQmFzaWNFbGVtZW50KSB7XG5cdCAgX2luaGVyaXRzKEdyb3VwLCBfQmFzaWNFbGVtZW50KTtcblx0XG5cdCAgZnVuY3Rpb24gR3JvdXAoY2FudmFzLCBncm91cCkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdyb3VwKTtcblx0XG5cdCAgICAvLyBTZXQgdHlwZSB0byBncm91cFxuXHQgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKEdyb3VwLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoR3JvdXApKS5jYWxsKHRoaXMsIGNhbnZhcywgZ3JvdXApKTtcblx0XG5cdCAgICBfdGhpcy5jb25maWcudHlwZSA9ICdncm91cCc7XG5cdCAgICBfdGhpcy5fX21lbWJlcnNfXyA9IFtdO1xuXHQgICAgcmV0dXJuIF90aGlzO1xuXHQgIH1cblx0ICAvKipcblx0ICAqIENoZWNrIGlmIGlzIHByb3BlciBlbGVtZW50IG9yIGdyb3VwXG5cdCAgKi9cblx0XG5cdFxuXHQgIF9jcmVhdGVDbGFzcyhHcm91cCwgW3tcblx0ICAgIGtleTogJ19fY2hlY2tFbF9fJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBfX2NoZWNrRWxfXyhlbGVtZW50KSB7XG5cdCAgICAgIGlmICghKGVsZW1lbnQgaW5zdGFuY2VvZiBCYXNpY0VsZW1lbnQpKSB7XG5cdCAgICAgICAgdGhyb3cgRXJyb3IoJ09ubHkgZWxlbWVudHMgb3IgZ3JvdXBzIGNhbiBiZSBhZGRlZCcpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICAvKipcblx0ICAgICogQ2hlY2sgaWYgaXMgcHJvcGVyIGdyb3VwXG5cdCAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdfX2NoZWNrR3JvdXBfXycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gX19jaGVja0dyb3VwX18oZWxlbWVudCkge1xuXHQgICAgICBpZiAoIShlbGVtZW50IGluc3RhbmNlb2YgR3JvdXApKSB7XG5cdCAgICAgICAgdGhyb3cgRXJyb3IoJ0dyb3VwIGV4cGVjdGVkJyk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIC8qKlxuXHQgICAgKiBBZGQgbmV3IGVsZW1lbnRzIG9yIGdyb3Vwc1xuXHQgICAgKiB0byBjdXJyZW50IGdyb3VwXG5cdCAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdhZGQnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZChlbGVtZW50KSB7XG5cdCAgICAgIHZhciBpID0gMDtcblx0ICAgICAgLy8gSWYgQXJyYXkgYWRkIGFsbCBlbGVtZW50c1xuXHQgICAgICBpZiAoIWlzTmFOKGVsZW1lbnQubGVuZ3RoKSkge1xuXHQgICAgICAgIGZvciAoaSA9IGVsZW1lbnQubGVuZ3RoOyBpLS07KSB7XG5cdCAgICAgICAgICB0aGlzLmFkZChlbGVtZW50W2ldKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICAgIH1cblx0ICAgICAgdGhpcy5fX2NoZWNrRWxfXyhlbGVtZW50KTtcblx0ICAgICAgLy8gUmVtb3ZlIHByZXZpb3VzIGdyb3VwO1xuXHQgICAgICBlbGVtZW50Lmdyb3VwLnJlbW92ZShlbGVtZW50KTtcblx0ICAgICAgLy8gYXNzc2lnbiBuZXcgZ3JvdXBcblx0ICAgICAgZWxlbWVudC5ncm91cCA9IHRoaXM7XG5cdCAgICAgIHRoaXMuX19tZW1iZXJzX18ucHVzaChlbGVtZW50KTtcblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9XG5cdCAgICAvKipcblx0ICAgICogQWRkIG5ldyBlbGVtZW50cyBvciBncm91cHNcblx0ICAgICogdG8gY3VycmVudCBncm91cCBmcm9tIGRpZmZlcmVudCBncm91cFxuXHQgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnYWRkQWxsRnJvbScsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gYWRkQWxsRnJvbShncm91cCkge1xuXHQgICAgICB2YXIgYXJyID0gdm9pZCAwLFxuXHQgICAgICAgICAgaSA9IDA7XG5cdCAgICAgIHRoaXMuX19jaGVja0dyb3VwX18oZ3JvdXApO1xuXHQgICAgICBhcnIgPSBncm91cC5fX21lbWJlcnNfXztcblx0ICAgICAgZm9yIChpID0gYXJyLmxlbmd0aDsgaS0tOykge31cblx0ICAgIH1cblx0ICAgIC8qKlxuXHQgICAgKiBSZW1vdmUgZWxlbWVudCBpcyBtZW1iZXIgb2YgY3VycmVudCBncm91cFxuXHQgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAncmVtb3ZlJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoZWxlbWVudCkge1xuXHQgICAgICB2YXIgbWVtYmVycyA9IHRoaXMuX19tZW1iZXJzX18sXG5cdCAgICAgICAgICBpID0gMCxcblx0ICAgICAgICAgIGlpID0gbWVtYmVycy5sZW5ndGgsXG5cdCAgICAgICAgICBqID0gMDtcblx0ICAgICAgdGhpcy5fX2NoZWNrRWxfXyhlbGVtZW50KTtcblx0ICAgICAgZm9yICg7IGkgPCBpaTsgKytpKSB7XG5cdCAgICAgICAgaWYgKG1lbWJlcnNbaV0gPT09IGVsZW1lbnQpIHtcblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICBpZiAoaSA9PT0gaWkpIHtcblx0ICAgICAgICAvLyBFbGVtZW50IG5vdCBmb3VuZFxuXHQgICAgICAgIHRocm93IEVycm9yKCdFbGVtZW50IG5vdCBpbiBjdXJyZW50IGdyb3VwJyk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgLy8gUmVtb3ZlIHRoZSBlbGVtZW50XG5cdCAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBpaTsgKytqKSB7XG5cdCAgICAgICAgICBtZW1iZXJzW2ogLSAxXSA9IG1lbWJlcnNbal07XG5cdCAgICAgICAgfVxuXHQgICAgICAgIG1lbWJlcnMucG9wKCk7XG5cdCAgICAgICAgZGVsZXRlIGVsZW1lbnQuZ3JvdXA7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9XG5cdCAgICAvKipcblx0ICAgICogUmVtb3ZlIGFsbCBlbGVtZW50c1xuXHQgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAncmVtb3ZlQWxsJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGwoKSB7XG5cdCAgICAgIHZhciBtZW1iZXJzID0gdGhpcy5fX21lbWJlcnNfXyxcblx0ICAgICAgICAgIGkgPSBtZW1iZXJzLmxlbmd0aDtcblx0ICAgICAgZm9yICg7IGktLTspIHtcblx0ICAgICAgICBkZWxldGUgbWVtYmVyc1tpXS5ncm91cDtcblx0ICAgICAgfVxuXHQgICAgICAvLyBSZW1vdmUgcmVmZXJlbmNlcyBvZiBhbGwgZWxlbWVudHNcblx0ICAgICAgdGhpcy5fX21lbWJlcnNfXyA9IFtdO1xuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH1cblx0ICAgIC8qKlxuXHQgICAgKiBPdmVycmlkaW5nIG1ldGhvZFxuXHQgICAgKiBFcmFzZSBjdXJyZW50IGdyb3VwIGFuZCBhbGwgaXRzIGNoaWxkcmVuXG5cdCAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdlcmFzZScsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZXJhc2UoKSB7XG5cdCAgICAgIHZhciBtZW1iZXJzID0gdGhpcy5fX21lbWJlcnNfXyxcblx0ICAgICAgICAgIGkgPSBtZW1iZXJzLmxlbmd0aDtcblx0ICAgICAgLy8gcmVtb3ZlIGFsbCBjaGlsZHJlblxuXHQgICAgICBmb3IgKDsgaS0tOykge1xuXHQgICAgICAgIG1lbWJlcnNbaV0uZXJhc2UoKTtcblx0ICAgICAgfVxuXHQgICAgICAvLyBSZW1vdmUgc2VsZlxuXHQgICAgICBfZ2V0KEdyb3VwLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKEdyb3VwLnByb3RvdHlwZSksICdlcmFzZScsIHRoaXMpLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdCAgfV0pO1xuXHRcblx0ICByZXR1cm4gR3JvdXA7XG5cdH0oQmFzaWNFbGVtZW50KTtcblx0XG5cdG1vZHVsZS5leHBvcnRzID0geyBlbGVtZW50OiBHcm91cCB9O1xuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gY2FudmFzbGl0ZS1lczUubWluLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgNDg3OTQ5ZDI3NDk0NjgyMGE0MzEiLCJsZXQgRWxlbWVudCA9IHJlcXVpcmUoJy4vRWxlbWVudHMvQmFzaWNFbGVtZW50LmpzJykuZWxlbWVudCxcbiAgR3JvdXAgPSByZXF1aXJlKCcuL0VsZW1lbnRzL0dyb3VwLmpzJykuZWxlbWVudCxcbiAgZG9jID0gZG9jdW1lbnQ7XG4vKipcbiogQ29uc3RydWN0b3IgZnVuY3Rpb24gdG8gaW5pdGlhbGl6ZSBDYW52YXNMaXRlXG4qL1xuY2xhc3MgQ2FudmFzTGl0ZSB7XG4gIGNvbnN0cnVjdG9yIChpZCkge1xuICAgIHRoaXMucm9vdEVsID0gZG9jLmdldEVsZW1lbnRCeUlkKGlkKTtcbiAgICB0aGlzLmNhbnZhc0VsID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIHRoaXMucm9vdEVsLmFwcGVuZENoaWxkKHRoaXMuY2FudmFzRWwpO1xuICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzRWwuZ2V0Q29udGV4dCgnMmQnKTtcbiAgfVxuICBlbGVtZW50ICgpIHtcbiAgICByZXR1cm4gbmV3IEVsZW1lbnQodGhpcyk7XG4gIH1cbiAgZ3JvdXAgKCkge1xuICAgIHJldHVybiBuZXcgR3JvdXAodGhpcyk7XG4gIH1cbn1cbi8vIGV4cG9zaW5nIGNhbnZhc2xpdGUgdG8gZ2xvYmFsIHNwYWNlXG5tb2R1bGUuZXhwb3J0cyA9IENhbnZhc0xpdGU7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvY29uc3RydWN0b3IuanMiLCJsZXQgR3JvdXAgPSByZXF1aXJlKCcuL0dyb3VwLmpzJykuZWxlbWVudDtcbi8qKlxuKiBCYXNpYyBFbGVtZW50IGNsYXNzXG4qIEdyb3VwcyBhbmQgb3RoZXIgRWxlbWVudHMgaW5oZXJpdHMgdGhpc1xuKiBjb250YWlucyBiYXNpYyBtZXRob2RzIGFuZCBwcm9wZXJ0aWVzIHJlcXVpcmVkIGJ5IGFsbCBncm91cHMgb3IgZWxlbWVudHMuXG4qL1xuY2xhc3MgQmFzaWNFbGVtZW50IHtcbiAgLyoqXG4gICogQmFzaUVsZW1lbnQgY29uc3RydWN0b3JcbiAgKiBhc3NpZ24gdGhlIGdyb3VwLCBzdG9yZSBjYW52YXNcbiAgKiBzZXQgdHlwZSBpbml0aWFsbHkgdG8gJ2Jhc2ljRWwnXG4gICovXG4gIGNvbnN0cnVjdG9yIChjYW52YXMsIGdyb3VwKSB7XG4gICAgaWYgKCFjYW52YXMpIHtcbiAgICAgIHRocm93IEVycm9yKCdjYW52YXMgbm90IHByb3ZpZGVkJyk7XG4gICAgfVxuICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xuICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgdHlwZTogJ2Jhc2ljRWwnLFxuICAgICAgdmlzaWJsZTogdHJ1ZVxuICAgIH07XG4gICAgLy8gSW5pdGlhbGx5IGFzc2lnbiByb290IGdyb3VwIGlmXG4gICAgLy8gZ3JvdXAgbm90IHByb3ZpZGVkXG4gICAgaWYgKGdyb3VwKSB7XG4gICAgICBpZiAoIShncm91cCBpbnN0YW5jZW9mIEdyb3VwKSkge1xuICAgICAgICB0aHJvdyBFcnJvcignTm90IGEgcHJvcGVyIEdyb3VwJyk7XG4gICAgICB9XG4gICAgICB0aGlzLmdyb3VwID0gZ3JvdXA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZ3JvdXAgPSBjYW52YXMucm9vdEdyb3VwO1xuICAgIH1cbiAgfVxuICAvKipcbiAgKiBBc3NpZ24gbmV3IGdyb3VwIG9yXG4gICogZ2V0IHRoZSBjdXJyZW50IGFzc2lnbmVkIGdyb3VwXG4gICovXG4gIGdyb3VwIChncm91cCkge1xuICAgIC8vIElmIGdyb3VwIGlzIHByb3ZpZGVkIGFzc2lnbiwgb3RoZXJ3aXNlXG4gICAgLy8gcmV0dXJuIGN1cnJlbnQgZ3JvdXBcbiAgICBpZiAoZ3JvdXApIHtcbiAgICAgIHRoaXMuZ3JvdXAucmVtb3ZlKHRoaXMpO1xuICAgICAgdGhpcy5ncm91cCA9IGdyb3VwO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmdyb3VwO1xuICAgIH1cbiAgfVxuICAvKipcbiAgKiBFcmFzZSBjdXJyZW50IGVsZW1lbnRcbiAgKi9cbiAgZXJhc2UgKCkge1xuICAgIHZhciBrZXk7XG4gICAgdGhpcy5ncm91cC5yZW1vdmUodGhpcyk7XG4gICAgLy8gZGVsZXRlIGV2ZXJ5IHByb3BlcnR5IG9mIGVsZW1lbnRcbiAgICBmb3IgKGtleSBpbiB0aGlzKSB7XG4gICAgICBpZiAodGhpcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzW2tleV07XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX19ub3RpZnlDaGFuZ2VfXygpO1xuICB9XG4gIC8qKlxuICAqIEhpZGUgY3VycmVudCBlbGVtZW50XG4gICovXG4gIGhpZGUgKCkge1xuICAgIGlmICh0aGlzLmNvbmZpZy52aXNpYmxlKSB7XG4gICAgICB0aGlzLmNvbmZpZy52aXNpYmxlID0gZmFsc2U7XG4gICAgICB0aGlzLl9fbm90aWZ5Q2hhbmdlX18oKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgLyoqXG4gICogU2hvdyBjdXJyZW50IGVsZW1lbnRcbiAgKi9cbiAgc2hvdyAoKSB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZy52aXNpYmxlKSB7XG4gICAgICB0aGlzLmNvbmZpZy52aXNpYmxlID0gdHJ1ZTtcbiAgICAgIHRoaXMuX19ub3RpZnlDaGFuZ2VfXygpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgKiBUb2dnbGUgY3VycmVudCBlbGVtZW50J3MgdmlzaWJpbGl0eVxuICAqL1xuICB0b2dnbGUgKCkge1xuICAgIHRoaXMuY29uZmlnLnZpc2libGUgPSAhdGhpcy5jb25maWcudmlzaWJsZTtcbiAgICB0aGlzLl9fbm90aWZ5Q2hhbmdlX18oKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgKiBCZWhhdmUgd2hlbiBwcm9wZXJ0eSBvZiBlbGVtZW50IGlzIGNoYW5nZWRcbiAgKi9cbiAgX19ub3RpZnlDaGFuZ2VfXyAoKSB7XG4gICAgaWYgKHRoaXMuY29uZmlnLnZpc2libGUpIHtcbiAgICAgIC8vIE5vdGlmeSBjaGFuZ2Ugb25seSBpZiB2aXNpYmxlXG4gICAgfVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge2VsZW1lbnQ6IEJhc2ljRWxlbWVudH07XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvRWxlbWVudHMvQmFzaWNFbGVtZW50LmpzIiwiLyoqXG4qIE1hbmFnZSBhbGwgdGhlIGdyb3VwIGVsZW1lbnRzIGJlbG9uZ3MgdG9cbiovXG5sZXQgQmFzaWNFbGVtZW50ID0gcmVxdWlyZSgnLi9CYXNpY0VsZW1lbnQuanMnKS5lbGVtZW50O1xuY29uc29sZS5sb2coQmFzaWNFbGVtZW50KTtcbi8qKlxuKiBNYW5hZ2UgZ3JvdXBzIHRoYXQgZWxlbWVudHMgYmVsb25nIHRvXG4qIGV4dGVuZHMgQmFzaWNFbGVtZW50XG4qL1xuY2xhc3MgR3JvdXAgZXh0ZW5kcyBCYXNpY0VsZW1lbnQge1xuICBjb25zdHJ1Y3RvciAoY2FudmFzLCBncm91cCkge1xuICAgIHN1cGVyKGNhbnZhcywgZ3JvdXApO1xuICAgIC8vIFNldCB0eXBlIHRvIGdyb3VwXG4gICAgdGhpcy5jb25maWcudHlwZSA9ICdncm91cCc7XG4gICAgdGhpcy5fX21lbWJlcnNfXyA9IFtdO1xuICB9XG4gIC8qKlxuICAqIENoZWNrIGlmIGlzIHByb3BlciBlbGVtZW50IG9yIGdyb3VwXG4gICovXG4gIF9fY2hlY2tFbF9fIChlbGVtZW50KSB7XG4gICAgaWYgKCEoZWxlbWVudCBpbnN0YW5jZW9mIEJhc2ljRWxlbWVudCkpIHtcbiAgICAgIHRocm93IEVycm9yKCdPbmx5IGVsZW1lbnRzIG9yIGdyb3VwcyBjYW4gYmUgYWRkZWQnKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICogQ2hlY2sgaWYgaXMgcHJvcGVyIGdyb3VwXG4gICovXG4gIF9fY2hlY2tHcm91cF9fIChlbGVtZW50KSB7XG4gICAgaWYgKCEoZWxlbWVudCBpbnN0YW5jZW9mIEdyb3VwKSkge1xuICAgICAgdGhyb3cgRXJyb3IoJ0dyb3VwIGV4cGVjdGVkJyk7XG4gICAgfVxuICB9XG4gIC8qKlxuICAqIEFkZCBuZXcgZWxlbWVudHMgb3IgZ3JvdXBzXG4gICogdG8gY3VycmVudCBncm91cFxuICAqL1xuICBhZGQgKGVsZW1lbnQpIHtcbiAgICBsZXQgaSA9IDA7XG4gICAgLy8gSWYgQXJyYXkgYWRkIGFsbCBlbGVtZW50c1xuICAgIGlmICghaXNOYU4oZWxlbWVudC5sZW5ndGgpKSB7XG4gICAgICBmb3IgKGkgPSBlbGVtZW50Lmxlbmd0aDsgaS0tOykge1xuICAgICAgICB0aGlzLmFkZChlbGVtZW50W2ldKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB0aGlzLl9fY2hlY2tFbF9fKGVsZW1lbnQpO1xuICAgIC8vIFJlbW92ZSBwcmV2aW91cyBncm91cDtcbiAgICBlbGVtZW50Lmdyb3VwLnJlbW92ZShlbGVtZW50KTtcbiAgICAvLyBhc3NzaWduIG5ldyBncm91cFxuICAgIGVsZW1lbnQuZ3JvdXAgPSB0aGlzO1xuICAgIHRoaXMuX19tZW1iZXJzX18ucHVzaChlbGVtZW50KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgKiBBZGQgbmV3IGVsZW1lbnRzIG9yIGdyb3Vwc1xuICAqIHRvIGN1cnJlbnQgZ3JvdXAgZnJvbSBkaWZmZXJlbnQgZ3JvdXBcbiAgKi9cbiAgYWRkQWxsRnJvbSAoZ3JvdXApIHtcbiAgICBsZXQgYXJyLFxuICAgICAgaSA9IDA7XG4gICAgdGhpcy5fX2NoZWNrR3JvdXBfXyhncm91cCk7XG4gICAgYXJyID0gZ3JvdXAuX19tZW1iZXJzX187XG4gICAgZm9yIChpID0gYXJyLmxlbmd0aDsgaS0tOykge1xuXG4gICAgfVxuICB9XG4gIC8qKlxuICAqIFJlbW92ZSBlbGVtZW50IGlzIG1lbWJlciBvZiBjdXJyZW50IGdyb3VwXG4gICovXG4gIHJlbW92ZSAoZWxlbWVudCkge1xuICAgIGxldCBtZW1iZXJzID0gdGhpcy5fX21lbWJlcnNfXyxcbiAgICAgIGkgPSAwLFxuICAgICAgaWkgPSBtZW1iZXJzLmxlbmd0aCxcbiAgICAgIGogPSAwO1xuICAgIHRoaXMuX19jaGVja0VsX18oZWxlbWVudCk7XG4gICAgZm9yICg7IGkgPCBpaTsgKytpKSB7XG4gICAgICBpZiAobWVtYmVyc1tpXSA9PT0gZWxlbWVudCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGkgPT09IGlpKSB7IC8vIEVsZW1lbnQgbm90IGZvdW5kXG4gICAgICB0aHJvdyBFcnJvcignRWxlbWVudCBub3QgaW4gY3VycmVudCBncm91cCcpO1xuICAgIH0gZWxzZSB7IC8vIFJlbW92ZSB0aGUgZWxlbWVudFxuICAgICAgZm9yIChqID0gaSArIDE7IGogPCBpaTsgKytqKSB7XG4gICAgICAgIG1lbWJlcnNbaiAtIDFdID0gbWVtYmVyc1tqXTtcbiAgICAgIH1cbiAgICAgIG1lbWJlcnMucG9wKCk7XG4gICAgICBkZWxldGUgZWxlbWVudC5ncm91cDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgLyoqXG4gICogUmVtb3ZlIGFsbCBlbGVtZW50c1xuICAqL1xuICByZW1vdmVBbGwgKCkge1xuICAgIGxldCBtZW1iZXJzID0gdGhpcy5fX21lbWJlcnNfXyxcbiAgICAgIGkgPSBtZW1iZXJzLmxlbmd0aDtcbiAgICBmb3IgKDsgaS0tOykge1xuICAgICAgZGVsZXRlIG1lbWJlcnNbaV0uZ3JvdXA7XG4gICAgfVxuICAgIC8vIFJlbW92ZSByZWZlcmVuY2VzIG9mIGFsbCBlbGVtZW50c1xuICAgIHRoaXMuX19tZW1iZXJzX18gPSBbXTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgKiBPdmVycmlkaW5nIG1ldGhvZFxuICAqIEVyYXNlIGN1cnJlbnQgZ3JvdXAgYW5kIGFsbCBpdHMgY2hpbGRyZW5cbiAgKi9cbiAgZXJhc2UgKCkge1xuICAgIGxldCBtZW1iZXJzID0gdGhpcy5fX21lbWJlcnNfXyxcbiAgICAgIGkgPSBtZW1iZXJzLmxlbmd0aDtcbiAgICAvLyByZW1vdmUgYWxsIGNoaWxkcmVuXG4gICAgZm9yICg7IGktLTspIHtcbiAgICAgIG1lbWJlcnNbaV0uZXJhc2UoKTtcbiAgICB9XG4gICAgLy8gUmVtb3ZlIHNlbGZcbiAgICBzdXBlci5lcmFzZSgpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge2VsZW1lbnQ6IEdyb3VwfTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9FbGVtZW50cy9Hcm91cC5qcyJdLCJzb3VyY2VSb290IjoiIn0=